<head>
  <meta property="og:title" content="HeyGoTimes"/>
  <meta property="og:type" content="news"/>
  <meta property="og:url" content="<%= root_url %>"/>
  <meta property="og:image" content="<%= root_url + "images/HeyGoTimes_logo.png" %> "/>

  <script type="text/javascript">
    function like(user, news, like)
    {
      // ask session data from server
      $.getJSON("/news/like.json", {user: user, news: news, like: like}, function(json)
      {
        if (like == 1)
          alert(json.name+' like this news, total: '+json.total);
        else
          alert(json.name+' unlike this news, total: '+json.total);

      }  );

    }


    function loadMore(type, pageNo) {
      var t = $("#paperContent");
      var url = '/paper/_show_paper_content?type='+type+'&page='+pageNo;
      var preview = $('#loading_more_news').html('<img src="images/fb_loading_large.gif" height="20" width="20" />');

      t.timeout = setTimeout(function () {
        $.get(url, function(response) {
          $("#paperContent").append(response);
          FB.XFBML.parse(document.getElementById('comments'));
        });
        preview.html('');
      }, 2000);
    }

    function changePaperType(type) {
      var url = '/paper/_show_paper_content?type='+type+'&page=1';
      $("#paperContent").fadeOut('slow').load(url);
      FB.XFBML.parse(document.getElementById('comments'));
      $("#paperContent").fadeIn('slow');
    }

    $(document).ready(function() {
      var currPage = 1;
      var currType = 'latest';

      $('#more_news').unbind('click').click(function() {
        loadMore(currType, ++currPage);
      });

      $('#menu-item-rank').unbind('click').click(function(){
        $('#menu-item-latest').removeClass("current-menu-item")
        $(this).addClass("current-menu-item")
        currPage = 1;
        currType = 'rank';
        changePaperType(currType);
      });

      $('#menu-item-latest').unbind('click').click(function(){
        $('#menu-item-rank').removeClass("current-menu-item")
        $(this).addClass("current-menu-item")
        currPage = 1;
        currType = 'latest';
        changePaperType(currType);
      });
    });

    function init_checkbox()
    {
        for(i=0;i<($('input').length);i++)
        {
            //console.log($('input')[i]) ;
            if( $('input')[i].type == "checkbox")
            {
                 $('input')[i].disabled = false ;
                 $('input')[i].checked = false ;

                 $('input')[i].style.display = "" ;
            }
        }

        $('#FeedbackTag_box')[0].disabled = true ;
        $('#FeedbackTag_box')[0].checked = false ;
        $('#FeedbackTag_box')[0].style.display= "none" ;
        $('#FeedbackTag_lab')[0].style.display= "none" ;

        $('#filter_dlg_t2')[0].style.display = "" ;
        $('#filter_dlg_t6')[0].style.display = "" ;
        $('#url_input')[0].style.display = "" ;
        $('#image_url')[0].style.display = "" ;

        $('#filter_dlg_t0')[0].firstChild.data = "<%= t(:report_a_news) %>" ;
        $('#news_submit')[0].value = "<%= t(:add_news) %>" ;


    }

  </script>

</head>


<div id="page">
  <div id="header">
    <div id="logo">
      <%= link_to( image_tag("/images/HeyGoTimes_logo.png"), {:controller =>'paper'}, {:title => 'to home page'} ) %>
    </div>
    <span id="filter_hint" title ="<%= t(:tip_for_filter)%>"><%= @newspaper_title.to_s %></span>

    <div id="page_head" >
      <%= show_page_head(:login_flag => true)  %>
    </div><!-- #page_head -->

  </div><!-- #header -->

  <div id="access">
    <div class="menu-header">
      <ul id="menu-area" class="menu">
        <li id="menu-item-rank" class="menu-item <%= 'current-menu-item' if (session[:news_type] == 'rank') %>"><a title="Rank" href="#"><%=t(:popular_news)%></a></li>
        <li id="menu-item-latest" class="menu-item <%= 'current-menu-item' if (session[:news_type] == 'latest') %>"><a title="Latest" href="#"><%=t(:latest_news)%></a></li>
        <li id="menu-item-report" class="menu-item fun-btn"><a name='btn1' class='osx btn1' title="<%= t(:m_report_news) %>" href="#" onclick="init_checkbox()"><%=t(:m_report)%></a></li>
        <li id="menu-item-filter" class="menu-item fun-btn"><a name='btn2' class='osx btn2' title="<%= t(:m_filter_setting) %>" href="#" onclick="init_checkbox()"><%=t(:m_filter)%></a></li>
      </ul>
    </div>
  </div><!-- #access -->

  <div id="main">
    <div id="content">
      <div id="paperContent">
        <% # TODO: use @paper_width %>
        <%= render :partial => 'paper/show_paper_content', :locals => {:news => @news} %>
      </div>
      <div id="more_news"><a><%= t(:m_more) %></a><span id="loading_more_news"></span></div>
    </div>

    <div id="sub">

      <!-- Show functional buttons : 1.Report_a_news/2.Edit_realtimes_news/3.my_AD  -->
      <div id="functionalButton">
        <%= render :partial => 'paper/show_fun_buttons' %>
      </div>

      <!-- show AD list-->
      <div id="ad">
        <% # TODO: use @ad_width, @ad_height, @ad_no %>
        <%= render :partial => 'paper/show_ad_list' %>
      </div>
    </div>
  </div><!-- #main -->


  <!-- method 'show_page_tail' would be used by all controller, so it's implemented in application_helper.rb -->
    <div id="footer">
      <%= show_page_tail %>
    </div>
</div> <!-- /page -->
  <!-- news/_show_page_tail.html.erb  -->
