<!DOCTYPE html>
<html manifest="drawing.manifest">
<head>
  <meta charset="utf-8">
  <meta name="viewport"
     content="width=320, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <title>繪圖</title>
  <style> * { margin:0; padding:0; position: absolute; }
    #title  {
      width:320px; heigth:20px;
      font-size:12px; padding:3px;
      background-color: black; color: white; 
    }
    #a_canvas {
      width:320px; height:460px; top:20px;
    }
  </style>
  <script type="text/javascript">
    var oldx, oldy;
    var canvas, con, canvas_top = 20;
    var colors = ["black","red","blue"];
    var color_index = 0;
    function $ (id) { return document.getElementById(id); }
    window.onload = function() {
      // 取得Canvas的上下文
      canvas = $("a_canvas");
      con = canvas.getContext("2d");
      con.strokeWidth = 2;
      con.strokeStyle = "black";
      // 對使用者的碰觸事件起反應
      canvas.ontouchstart = function (e) { drawLine(e, true);  };
      canvas.ontouchmove  = function (e) { drawLine(e, false); };
      canvas.ontouchend   = function (e) { drawLine(e, false); };
      // 點擊標題以改變描繪顏色
      $("title").onclick = function() {
        var cur = colors[(++color_index) % colors.length];
        $("title").style.backgroundColor = cur;
        con.strokeStyle = cur;
      };
    };
    // 處理事件並進行描繪
    function drawLine(event, isStart) {
      event.preventDefault();
      if (event.touches.length == 0) return;
      var t = event.touches[0];
      var mx = t.pageX;
      var my = t.pageY - canvas_top;
      if (isStart) {
        oldx = mx - 1;
        oldy = my - 1;
      }
      con.beginPath();
      con.moveTo(oldx, oldy);
      con.lineTo(mx, my);
      con.stroke();
      oldx = mx; oldy = my;
    }
  </script>
</head><body>
  <div id="title">繪圖程式</div>
  <canvas id="a_canvas" width="320" height="460"></canvas>
</body></html>
